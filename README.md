# @grunmouse/format-recursive

Модуль для выполнения подстановок в строках. Позволяет использовать аргументы и рекурсивный синтаксис.

## Функции

### @function use(tmpl, vars) 
выполняет подстановку значений в строку
* @param tmpl : {String} - шаблон;
* @param vars : {Object<String.(String|Function)>} - карта подставляемых значений, имена - это имена параметров, а значения должны быть строками или функциями, возвращающими строки.
* @return {String}

### @function compile(tmpl) 
компилирует шаблон в функцию, делающую подстановки в один и тот же шаблон
* @param tmpl : {String} - шаблон;
* @return Function<(vars : Object)=>(String)> - возвращает функцию, котоарая принимает карту подстановки


## Синтаксис

### Служебные символы:
```
\ $ ! { } < > [ ]
```

- \ - знак экранирования. Следующий за ним символ будет выведен как есть.
- ${ ... } - шаблона подстановки
- ! - оператор подстановки с параметрами
- <...> - скобки значения параметра
- [...] - скобки имени

### Подстановка

#### Подстановка без параметров
```
${NAME}
```

NAME - имя значения в карте. Значение будет подставлено в строку вместо шаблона

#### Подстановка с параметрами
```
${NAME!arg1<val1> arg2<val2>}
```

NAME - имя значения в карте\
arg1, arg2 - имена подставляемых значений\
val1, val2 - подставляемые значения, они тоже могут содержать подстановки, которые будут вычислены заранее

Если значение, лежащее по имени NAME, содержит подстановки по имени arg1 или arg2, то вместо них будут подставлены значения val1 и val2 соответственно.

### Имя

Имя подстановки или параметра может быть
* Валидным идентификатором, начинающимся с буквы, подчёркивания или доллара, и содержащим буквы, цифры, подчёркивания или доллары,
* Числом в десятичной системе,
* Произвольной строкой, заключённой в квадратные скобки.

### Фигурные скобки
```
{}
```
Фигурные скобки, если они не заэкранированы должны быть парными, иначе произойдёт ошибка.

### Макросы
```
$${NAME!arg1<val1> arg2<val2>}
```

Будут преобразованы в код подстановок. Аргументы будут вычислены.